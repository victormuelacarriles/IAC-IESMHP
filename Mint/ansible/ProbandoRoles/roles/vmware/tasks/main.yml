#Haciendo: hay que poner el path del bundle de VMware Workstation Pro
#  ya lo he descargado y  tengo que copiarle a la m치quina virtual


- name: Comprobar si VMware est치 instalado
  shell: vmware --version
  register: vmware_check
  ignore_errors: true
  changed_when: false

- name: Extraer versi칩n instalada de VMware
  set_fact:
    vmware_installed_version: "{{ vmware_check.stdout | regex_search('[0-9]+\\.[0-9]+\\.[0-9]+') }}"
  when: vmware_check.rc == 0

- name: Mostrar versi칩n instalada de VMware
  debug:
    msg: "VMware Workstation instalado: {{ vmware_installed_version | default('ninguna') }}"

- name: Copiamos el fichero .bundle al equipo remoto
  copy:
    src: "{{ vmware_bundle_path }}"
    dest: "/tmp/VMware-Workstation.bundle"
  when: vmware_installed_version is not defined or vmware_installed_version != vmware_version

- name: Hacer ejecutable el instalador .bundle
  file:
    path: "/tmp/VMware-Workstation.bundle"
    mode: '0755'
  when: vmware_installed_version is not defined or vmware_installed_version != vmware_version

- name: Ejecutar instalador de VMware
  command: "/tmp/VMware-Workstation.bundle --eulas-agreed --required --console"
  when: vmware_installed_version is not defined or vmware_installed_version != vmware_version
